<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1">
		
		<title>유저 조회 페이지</title>
		
		<link href="/public/semantic.min.css" rel="stylesheet" >
		
		
		<style>
			* {
				padding:0;
				margin:0;
				box-sizing:border-box;
			}
			
			html {
				width:100%;
				height:100%;
			}
			
			body {
				width:100%;
				height:100%;
				color: #000;
				background-color: #fff;
			}
					
			.container {
				margin-right: auto;
				margin-left: auto;
				padding-left: 20px;
				padding-right: 20px;
			}
	
			span {
				color: #999;
			}
			
			#titleOutput {
				margin-bottom: 10px;
				line-height: 1.2em;
			}
			
			#contentsOutput {
				margin-top: 10px;
				margin-bottom: 10px;
				line-height: 1.8em;
			}
	  
			#board_title {
				font-size:1.2em;
				font-weight:bold;
				color:teal;
			}
	.align{
		float: left;
	}
	.align2{
		float: right;
		display: inline;
	}
	.hidedbutton{
		display: none;
	}
	.box{
		display: inline;
	}
		</style>
			<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
			integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l"
			crossorigin="anonymous"
		/>
				<link rel="stylesheet" href="/public/assets/css/main.css" />
				 <script src="https://cdn.jsdelivr.net/npm/vue@2.5.2/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue-resource@1.3.4"></script>
		<script src="/public/jquery-3.1.1.min.js"></script>
		<script src="/public/semantic.min.js"></script>
		<link href="/public/cleditor/jquery.cleditor.css" rel="stylesheet" />
		<script src="/public/cleditor/jquery.cleditor.min.js"></script>
		<script>
			$(document).ready(function() {
				var output = $("#contentsOutput").text();
				
				
				$("#contentsOutput").html(output);
				 
			});

		</script>
<script>
	function show(idforcomment){
		var visibility=  document.getElementById(idforcomment).style.display;
		if(visibility=='none'){
		 document.getElementById(idforcomment).style.display='block';
		}else{
		 document.getElementById(idforcomment).style.display='none';
		}
		   

	}

 </script>
		<script>
			function modify(){
			   if(document.getElementById("modifyId").readOnly==true){
				   document.getElementById("modifyId").readOnly=false;
				   document.getElementById("modifyButton").style.display="none"
				   if(document.getElementById("modifyButton2").style.display=="none")
				   document.getElementById("modifyButton2").style.display="block"
			   }
		   else{
			   document.getElementById("modifyId").readOnly=true;
			   document.getElementById("modifyButton").style.display="block"
			   if(document.getElementById("modifyButton2").style.display=="block")
				   document.getElementById("modifyButton2").style.display="none"
		   }
		   
			}
			   
	   
	   </script>
	</head>
	<body>
	
		<div class="container">
			<br>

			<div class="ui raised segment">
				<a class="ui blue ribbon label">게시판</a>
      		
							
				<div class="ui blue fluid card">
					 <div class="content">
						
						
								<form class="btn btn-default btn-sm"  method="post" action="/user/modifyUser">
									<input style="display:inline-block; width:50%" type="text" id="modifyId" readonly name="idmodify" value="<%= user.name %>">
									<input type="button" id="modifyButton" style="float:right;" value="수정" onclick="modify()" />
									<input type="submit" id="modifyButton2"  style="float:right; display:none;" value="완료" onclick="modify()" />
								</form>
							
								
								<form class="btn btn-default btn-sm"  method="post" action="/user/deleteUser">
									<input type="submit" id="modifyButton" style="float:right;" value="탈퇴" />
								</form>
							
	   					<div class="meta">
	     					<p class="card-text">아이디: <strong><%= user.email %></strong></p>
							<p class="card-text">소속 부대: <strong><%= user.group %></strong></p>
							<p class="card-text">고유 번호/군번: <strong><%= user.own_number %></strong></p>
	     				</div>
	   						<p class="card-text">
								<small class="text-muted"
									>총 대출 권 수 :
									<span class="badge badge-pill badge-success" onclick="javascript:window.location='/views/myPage'"><%=posts.reservationlist.length%></span></small
								>
							<% var delayed_book=0;
								for (var i = 0; i < posts.reservationlist.length; i++) {
									
									var borrow_day = posts.reservationlist[i].updated_at;
									var today = new Date();
									
									var dateTerm = Math.ceil((today.getTime()-borrow_day.getTime())/(1000*3600*24));
									if(borrow_day.getMonth==today.getMonth){
										dateTerm=(today.getDate()-borrow_day.getDate());
									}
									if(dateTerm>14){
										delayed_book++;
									}
							%>
								
							<%}%>
								<small class="text-muted">연체 중인 도서 :
									<span class="badge badge-pill badge-success" onclick="javascript:window.location='/views/myPage'"><%=delayed_book%></span></small>
							</p>
					 </div>
	  				<div class="extra content">
	    				<div class="right floated author">
	      					
	    				</div>
	  				</div>
					
				</div> 
				<div id="app-6" style="overflow:scroll; width:100%; height:400px;">
					<div class="ui blue fluid card"  v-for="data in datas"   v-on:click="show(data._id)">
                                <div class="content">
                                    <div class="sixteen wide column">
                                        <div class="ui header" style="inline-block">
                                            <h4 class="ui left aligned header ">
                                                {{data.contents}}
                                            </h4>
                                      <h5 class="ui left aligned header ">
                                                {{data.created_at}}
                                            </h5>
												
                                        </div>
										
                                    </div>
									
										
                                </div>
                            </div>
	
				</div>
				
       
			</div>
					<button type="button" class="btn btn-outline-secondary mt-2" onclick="location.href='/'">Home</button>
		<!-- Footer -->
	
		</div>
				<% include ./footer.ejs %>
			<script>
		var app6 = new Vue({
		  el: '#app-6',
		  data: {
			datas: [],
		  },
	mounted() {
 		 this.$nextTick(function () {
			 
	  		console.log("sended");
    		this.$http.get('/user/profile_reivew') 
					.then(function(response) {
					  console.log(response);   
					  this.datas = response.data
		

					});
  })
},
        methods: {
			show:function(id){
				window.location='/book/showbook/'+id;
				
			},
			getData: function() {
		console.log("sended");
    		this.$http.get('/index/announce') 
					.then(function(response) {
					  console.log(response);  

					  this.datas = response.data
		

					});
			  },
    	},

		});

		</script>
	</body>
</html>


